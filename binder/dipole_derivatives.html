<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dipole derivatives | 一题多解</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="description" content="能看懂的自然哲学">
    <link rel="preload" href="/assets/css/0.styles.2be61e54.css" as="style"><link rel="preload" href="/assets/js/app.5f819d97.js" as="script"><link rel="preload" href="/assets/js/2.94db9d73.js" as="script"><link rel="preload" href="/assets/js/16.d2dd18bf.js" as="script"><link rel="prefetch" href="/assets/js/10.04320aae.js"><link rel="prefetch" href="/assets/js/11.59dd88e0.js"><link rel="prefetch" href="/assets/js/12.f916963e.js"><link rel="prefetch" href="/assets/js/13.14bc8a22.js"><link rel="prefetch" href="/assets/js/14.e83b2397.js"><link rel="prefetch" href="/assets/js/15.1a6ed31e.js"><link rel="prefetch" href="/assets/js/17.9b97420b.js"><link rel="prefetch" href="/assets/js/18.be9da792.js"><link rel="prefetch" href="/assets/js/19.056a3413.js"><link rel="prefetch" href="/assets/js/20.ff1541ad.js"><link rel="prefetch" href="/assets/js/21.636326ab.js"><link rel="prefetch" href="/assets/js/22.dd90af00.js"><link rel="prefetch" href="/assets/js/23.2590953f.js"><link rel="prefetch" href="/assets/js/24.c109ca16.js"><link rel="prefetch" href="/assets/js/25.04140c2d.js"><link rel="prefetch" href="/assets/js/26.88840269.js"><link rel="prefetch" href="/assets/js/27.04a991fa.js"><link rel="prefetch" href="/assets/js/28.e934d870.js"><link rel="prefetch" href="/assets/js/29.7b4d86ab.js"><link rel="prefetch" href="/assets/js/3.a92f1ec2.js"><link rel="prefetch" href="/assets/js/30.1dd94f13.js"><link rel="prefetch" href="/assets/js/31.bf958308.js"><link rel="prefetch" href="/assets/js/32.ae5f315b.js"><link rel="prefetch" href="/assets/js/33.0b545209.js"><link rel="prefetch" href="/assets/js/34.b63c8aa1.js"><link rel="prefetch" href="/assets/js/35.8adc21e1.js"><link rel="prefetch" href="/assets/js/36.cc4dddc0.js"><link rel="prefetch" href="/assets/js/37.27773325.js"><link rel="prefetch" href="/assets/js/38.0ff75ae3.js"><link rel="prefetch" href="/assets/js/39.25a72a96.js"><link rel="prefetch" href="/assets/js/4.6eaeb686.js"><link rel="prefetch" href="/assets/js/40.8bf3a212.js"><link rel="prefetch" href="/assets/js/41.13fb97d4.js"><link rel="prefetch" href="/assets/js/42.a762583a.js"><link rel="prefetch" href="/assets/js/43.78b398f1.js"><link rel="prefetch" href="/assets/js/44.118b69b9.js"><link rel="prefetch" href="/assets/js/45.e6fa05f7.js"><link rel="prefetch" href="/assets/js/5.500f7896.js"><link rel="prefetch" href="/assets/js/6.4bbb7ba8.js"><link rel="prefetch" href="/assets/js/7.b0148503.js"><link rel="prefetch" href="/assets/js/8.8c80f6d0.js"><link rel="prefetch" href="/assets/js/9.b23e20cd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2be61e54.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">一题多解</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  小学
</a></div><div class="nav-item"><a href="/middle/" class="nav-link">
  中学
</a></div><div class="nav-item"><a href="/high/" class="nav-link">
  大学
</a></div><div class="nav-item"><a href="/binder/" class="nav-link router-link-active">
  模拟
</a></div><div class="nav-item"><a href="/jin/" class="nav-link">
  SM
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  小学
</a></div><div class="nav-item"><a href="/middle/" class="nav-link">
  中学
</a></div><div class="nav-item"><a href="/high/" class="nav-link">
  大学
</a></div><div class="nav-item"><a href="/binder/" class="nav-link router-link-active">
  模拟
</a></div><div class="nav-item"><a href="/jin/" class="nav-link">
  SM
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/binder/" class="sidebar-link">计算机模拟</a></li><li><a href="/binder/VMD_commands_basis.html" class="sidebar-link">VMD中的基本命令</a></li><li><a href="/binder/gnuplot.html" class="sidebar-link">Calculate the average of a column of data (求某列数据的平均值)</a></li><li><a href="/binder/conda.html" class="sidebar-link">Anaconda</a></li><li><a href="/binder/cp2k.html" class="sidebar-link">CP2K</a></li><li><a href="/binder/stimulated_raman_spectroscopy.html" class="sidebar-link">飞秒受激拉曼光谱</a></li><li><a href="/binder/dipole_derivatives.html" class="active sidebar-link">Dipole derivatives</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/binder/dipole_derivatives.html#dipole-derivatives" class="sidebar-link">Dipole derivatives</a></li><li class="sidebar-sub-header"><a href="/binder/dipole_derivatives.html#to-calculate-dipole-moment-derivative-and-dipole-polarizibility-derivative" class="sidebar-link">To calculate dipole moment derivative and dipole polarizibility derivative</a></li></ul></li><li><a href="/binder/2018--abinitio.html" class="sidebar-link">ab initio Simulations</a></li><li><a href="/binder/multi_dim_quantum_dynamics.html" class="sidebar-link">Multidimensional Quantum Dynamics</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="dipole-derivatives"><a href="#dipole-derivatives" class="header-anchor">#</a> Dipole derivatives</h2> <p>Arivazhagan asked a question: &quot;How can we find the dipole moment derivative for a molecule using DFT calculations?&quot;</p> <p>Rafik Karaman answered: &quot; There is NO such thing called dipole moment of a molecule. There is a dipole moment of a functional group. Molecule have dielectric constants. For example water has a dielectric constant of about 78.</p> <p>For the calculation of dielectric constant using DFT, please read the following publications:
1-Microelectronics Reliability
Volume 39, Issue 2, February 1999, Pages 279–284</p> <p>Density functional theory applied to the calculation of dielectric constant of low-k materials
A. Courtot-Descharlesa,  F. Piresb, P. Pailleta, J.L. Leraya
[doi:10.1016/S0026-2714(98)00237-6]</p> <p>Abstract</p> <p>The interest of low-k dielectric materials to reduce capacitance in multilevel metal interconnects of integrated circuits is well known in the semiconductor industry. The use of these materials (especially hydrogen silsesquioxane (HSQ) and methyl silsesquioxane (MSQ): intermetal dielectric applications in the back end of line fabrication) leads to a reduction of the dielectric constant from k≅4 in a traditional intermetal dielectric material of silicon dioxide to a value of ≅2.5–3. The physical difference between HSQ or MSQ and a-SiO2 is the presence of Si–H bonds (for HSQ) or Si–CH3 bonds (for MSQ) and the density of the material. A theoretical calculation of bond polarizability (Si–H or Si–CH3) associated to experimental values of electric dipole densities can lead, using the Clausius-Mossotti relationship, to the calculation of the dielectric constant. After validation of the calculation methods both on simulation and experimental values, it is shown that for a constant density, the difference between the materials could be due to the bond polarizability and furthermore that this difference accounts, in part, for the value of dielectric constant. Consequently, even if densification remains the main parameter explaining low-k values, the polarizability of building units of these materials is not negligible.&quot;</p> <p>Arivazhagan said:&quot;Thank you very much, Rafik. Is it possible to do DFPT calculations using Gaussian program? Can we calculate the complex permittivity?
I understood that the term polar molecule means a molecule that has a dipole moment. The polar nature of the molecule is due to the dipole moment of the constituent functional group. I used the phrase in that sense. The <strong>dipole moment derivative</strong> is required to investigate the nature of H-bonds (blue and red shifting).&quot;</p> <p>Rafik Karaman said:
&quot;Dear Mr. Arivazhagan, Dipole moment is a measure of the functional group in the molecule. The sume of all the dipole moments in the group gives the term called dielectric constant. To my knoweledge, there is no way to run DFPT in Gaussian.
For DFPT  calculations, see the following link:</p> <p>[http://pubs.rsc.org/en/content/articlehtml/2014/fd/c4fd00168k]</p> <p>For calculating complex permititivity, use the attached file. Hoping this time my answer is to the point.&quot;</p> <p>Arivazhagan then asked:
&quot;If the sum of all the dipole moments in a functional group gives the term called dielectric constant, then the dipole moment should equal the dielectric constant. But they are found to assume different values for a given molecule. Why?&quot;</p> <p>Thomas Mayerhoefer said: &quot;Simple answer is: a single molecule does NOT have a dielectric constant, but it definitely possess a quantity called dipole moment. A dielectric constant is in contrast to the dipole moment a MACROSCOPIC quantity that starts to make sense as soon as you have an ENSEMBLE of molecules which also includes INTERACTION between the molecules. Indeed liquid water is the best example as it is the hydrogen bonding between molecules that is responsible for the high dielectric constant in liquid water (and the rotation of the permanent dipole in an electric field of comparably low frequenccy). Ice on the other hand has a comparably low dielectric constant (as the rotation is frozen) - but it is the same molecule!&quot;</p> <p>一个体系有可测量的电介质常数的条件是:(组成它的大量分子之间有相互作用; 每个分子有电偶极矩)。液态水就是一个具有很高电介质常数的具体例子，因为每个水分子都具有固有电偶极矩，且水分子之间有氢键且固有电偶极矩在低频外场中可以旋转。 冰中的水分子的旋转自由度被限制，所以，冰的电介质常数要小些.
在微波频段，冰的电介质常数大约为1,而水的电介质常数是80. 相差约80倍数。
雷达的频率恰好在微波频段，雷达激光会与液态水分子发生相互作用。因此，雷达激光能很容易地穿过冰，但是却在暴雨天气被反射。</p> <p>光在介质中传播的速度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo>=</mo><mi>c</mi><mi mathvariant="normal">/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">v=c/n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mrel">=</span><span class="mord mathit">c</span><span class="mord mathrm">/</span><span class="mord mathit">n</span></span></span></span>.</p> <p>Fumiyuki Ito:</p> <p>&quot;Dr. Arivazhagan, In the <strong>frequency calculation</strong> with Gaussian, <strong>dipole derivatives</strong> are calculated to determine infrared intensity.  If you look at the last part of the output file of Gaussian, you can find the following session: in the case of H2O at the RHF/6-31G level,</p> <p>If you would like to obtain full tables for the dipole derivatives, use the FORMCHK command to get formatted chekpoint file *.fch from binary chekpoint file *.chk.  As far as I remember, dipole derivatives are punched in the *.fch file in the atomic unit with input orientation.
I hope this would be of some help for you. &quot;</p> <p>按照Ito所说，可以通过频率计算来得到dipole derivatives. 问：　如何做频率计算?</p> <h2 id="to-calculate-dipole-moment-derivative-and-dipole-polarizibility-derivative"><a href="#to-calculate-dipole-moment-derivative-and-dipole-polarizibility-derivative" class="header-anchor">#</a> To calculate dipole moment derivative and dipole polarizibility derivative</h2> <p>2019-4-9</p> <p>The DFT MD trajectory (40 ps), sampled every 1 ps.</p> <p>1a. For <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> in the  given trajectory file <strong>pos.xyz</strong>, for a certain H2O molecule <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> name the two OH bonds as OH bond 1 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\epsilon=1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϵ</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>) and OH bond 2 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\epsilon=-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϵ</span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathrm">1</span></span></span></span>) .</p> <p>1b. Elongate OH bond 1 (OH1), and keep other bonds still, then obtain a updated coordinate file pos_t0_i_index_1.xyz, index_1 is the index of H in OH1.</p> <p>1c. Calculate the wannier centers for the system which is represented by the coordinate file <strong>pos_t0_i_index_1_delta_r.xyz</strong>.</p> <p>1d. Calculate the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span> component of the dipole moment for OH1 in water molecule <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> get <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><msubsup><mi>u</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow><mrow><mi>b</mi><mo separator="true">,</mo><mi>r</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">mu^{b, r+\Delta r}_{k,i,1}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.404432em;vertical-align:-0.4374159999999999em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord"><span class="mord mathit">u</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">b</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">+</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>μ</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow><mrow><mi>b</mi><mo separator="true">,</mo><mi>r</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow></msubsup><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>Z</mi><mi>i</mi></msub><msub><mi>R</mi><mi>i</mi></msub><mo>−</mo><mn>2</mn><msubsup><mi>r</mi><mrow><mi>e</mi><mi>l</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>n</mi><mtext></mtext><mi>o</mi><mi>n</mi><mtext></mtext><mi>O</mi><mi>H</mi><mn>1</mn></mrow><mi>w</mi></msubsup><mo>−</mo><msubsup><mi>r</mi><mrow><mi>l</mi><mi>o</mi><mi>n</mi><mi>e</mi><mtext></mtext><mi>p</mi><mi>a</mi><mi>i</mi><mi>r</mi></mrow><mi>w</mi></msubsup></mrow><annotation encoding="application/x-tex">\mu^{b,r+\Delta r}_{k,i,1} = \sum_i Z_i R_i -2 r^w_{electron \ on \ OH1} -r^w_{lone \ pair}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.404432em;vertical-align:-0.4374159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">b</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">+</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mspace"></span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mspace"></span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.02778em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mspace"></span><span class="mord mathit">p</span><span class="mord mathit">a</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p> <p>1a'--1d': similar to 1a-1d, get <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>μ</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow><mrow><mi>b</mi><mo separator="true">,</mo><mi>r</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mu^{b,r-\Delta r}_{k,i,1}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.404432em;vertical-align:-0.4374159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">b</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">−</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></p> <p>1e. In bond OH1 frame, calculate the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span>-component dipole moment derivative for OH1 in water molecule <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span></p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>μ</mi><mi>b</mi></msup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><msub><mo>)</mo><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo>=</mo><mo>(</mo><msubsup><mi>μ</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow><mrow><mi>b</mi><mo separator="true">,</mo><mi>r</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow></msubsup><mo>−</mo><msubsup><mi>μ</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow><mrow><mi>b</mi><mo separator="true">,</mo><mi>r</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow></msubsup><mo>)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">(\frac{\partial \mu^b}{\partial r})_{k,i,1}= (\mu^{b,r+\Delta r}_{k,i,1} -\mu^{b,r-\Delta r}_{k,i,1})/2\Delta r</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.047428em;"></span><span class="strut bottom" style="height:1.4848439999999998em;vertical-align:-0.4374159999999999em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord mathit">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">b</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">+</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">b</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">−</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mord mathrm">2</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span></p> <p>1f. Similarly, calculate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>η</mi><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\eta\xi</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">η</span><span class="mord mathit" style="margin-right:0.04601em;">ξ</span></span></span></span>-component of the dipole polarizability for OH2.</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>α</mi><mi>b</mi></msup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><msub><mo>)</mo><mrow><mi>η</mi><mi>ξ</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mo>(</mo><msubsup><mi>α</mi><mrow><mi>η</mi><mi>ξ</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mo>−</mo><mn>1</mn></mrow><mrow><mi>b</mi><mo separator="true">,</mo><mi>r</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow></msubsup><mo>−</mo><msubsup><mi>α</mi><mrow><mi>η</mi><mi>ξ</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mo>−</mo><mn>1</mn></mrow><mrow><mi>b</mi><mo separator="true">,</mo><mi>r</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow></msubsup><mo>)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mi mathvariant="normal">Δ</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">(\frac{\partial \alpha^b}{\partial r})_{\eta\xi,i,-1}= (\alpha^{b,r+\Delta r}_{\eta\xi,i,-1} -\alpha^{b,r-\Delta r}_{\eta\xi,i,-1})/2\Delta r</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.99532em;"></span><span class="strut bottom" style="height:1.4327359999999998em;vertical-align:-0.4374159999999999em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord mathit">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">η</span><span class="mord mathit" style="margin-right:0.04601em;">ξ</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord">−</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:-0.0037em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">η</span><span class="mord mathit" style="margin-right:0.04601em;">ξ</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord">−</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">b</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">+</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.3013079999999999em;margin-left:-0.0037em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">η</span><span class="mord mathit" style="margin-right:0.04601em;">ξ</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord">−</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">b</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mbin">−</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mord mathrm">2</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span></p> <p>( The problem:
<strong>How to calculate the polarizability for a OH bond from Wannier centers?</strong> )</p> <p>2.Repeat calculation 1a-1f for all other water molecules at time <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> in <strong>pos.xyz</strong>.</p> <p>3.Repeat step 1 and 2 for all other position file at time <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mn>4</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">t=1, 2 , 3 ,..., 40</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord mathrm">4</span><span class="mord mathrm">0</span></span></span></span> ps in <strong>pos.xyz</strong>.</p> <p>4.Calculate the average of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>μ</mi><mi>k</mi><mi>b</mi></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><msub><mo>)</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>ϵ</mi></mrow></msub></mrow><annotation encoding="application/x-tex">(\frac{\partial \mu^b_k}{\partial r})_{i,\epsilon}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.1164399999999999em;"></span><span class="strut bottom" style="height:1.4614399999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.51512em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.2930285714285714em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord mathit">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">ϵ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>α</mi><mrow><mi>η</mi><mi>ξ</mi></mrow><mi>b</mi></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>r</mi></mrow></mfrac><msub><mo>)</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>ϵ</mi></mrow></msub></mrow><annotation encoding="application/x-tex">(\frac{\partial \alpha^b_{\eta\xi}}{\partial r})_{i,\epsilon}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.21366em;"></span><span class="strut bottom" style="height:1.55866em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.61234em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.2930285714285714em;margin-left:-0.0037em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">η</span><span class="mord mathit" style="margin-right:0.04601em;">ξ</span></span></span></span><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord mathit">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit">ϵ</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> for all OH bonds, respectively.</p> <h3 id="dielectric"><a href="#dielectric" class="header-anchor">#</a> dielectric</h3> <p>什么叫电介质(dielectric)？置于电池两极之间的绝缘物质，比如玻璃，水。
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><mi>ϵ</mi><mfrac><mrow><mi>A</mi><msub><mi>ϵ</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">C = \epsilon \frac{A\epsilon_0}{d}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.8933309999999999em;"></span><span class="strut bottom" style="height:1.2383309999999998em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mrel">=</span><span class="mord mathit">ϵ</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">d</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4149999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">A</span><span class="mord"><span class="mord mathit">ϵ</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span>,
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ϵ</span></span></span></span> 称为该电介质的电介质常数。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span>,面积；<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span></span></span></span>,两电极的距离。
电介质使得电容存储更多的电荷。因为随着充电过程进行，电容两极的电荷形成电压，使得电介质中的极性分子从无序状态变得更有序,与此同时，两极间的电场被增强了。这个过程中，电场对这些电偶极矩(分子)做功W={\bf p}\cdot {\bf E}. 此过程中，电场在与温度对抗。温度（或熵？或更普遍地说，是涨落或噪声）要使分子的电偶极矩尽量地变得无序。<br>
正如我将一块砖从地面带到房顶上，我对这块砖做了功，相应地砖头就存储了更多的能量(勢能)。由于电场对电介质做了功，电介质里这些有序排列的分子(电偶极矩)也存储了一部分额外的能量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span></span></span></span>。[1]</p> <p>所以，电极板上的电荷分两种自由电荷和感应电荷。自由电荷密度用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mrow><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{f}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>描述，感应电荷密度用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{induced}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">d</span><span class="mord mathit">u</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>.</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><mi>n</mi><mi>e</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>Q</mi><mi>f</mi></msub><mo>+</mo><msub><mi>Q</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Q_{net} = Q_f + Q_{induced}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">Q</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">d</span><span class="mord mathit">u</span><span class="mord mathit">c</span><span class="mord mathit">e</span><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>.</p> <h3 id="frequency-calculation-by-cp2k"><a href="#frequency-calculation-by-cp2k" class="header-anchor">#</a> frequency calculation by CP2K</h3> <p>问：什么时候我们可以做频率计算？</p> <p>答：If I want to see whether or not a system have reached  its minimum (global or local does not matter here), I can run the frequency calculation.</p> <div class="language-fortran extra-class"><pre class="language-fortran"><code><span class="token comment">! Possibly restart (if explicitly requested)</span>
@<span class="token keyword">IF</span> <span class="token number">1</span>
<span class="token punctuation">&amp;</span>EXT_RESTART ON
   RESTART_DEFAULT F
   RESTART_FILE_NAME FLUORGEOM<span class="token operator">-</span><span class="token number">1.</span>restart
   RESTART_POS T
   RESTART_COUNTERS T
<span class="token punctuation">&amp;</span><span class="token keyword">END</span> EXT_RESTART
@<span class="token keyword">ENDIF</span>

<span class="token punctuation">&amp;</span>GLOBAL
   PROJECT  FLUORGEOM
   RUN_TYPE NORMAL_MODES
   PRINT_LEVEL LOW
<span class="token punctuation">&amp;</span><span class="token keyword">END</span> GLOBAL

<span class="token punctuation">&amp;</span>VIBRATIONAL_ANALYSIS
    NPROC_REP <span class="token number">4</span>
    DX <span class="token number">0.001</span>
<span class="token comment">!   INTENSITIES</span>
    <span class="token punctuation">&amp;</span><span class="token keyword">PRINT</span>
      <span class="token punctuation">&amp;</span>PROGRAM_RUN_INFO ON
      <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
      <span class="token punctuation">&amp;</span>MOLDEN_VIB
       FILENAME<span class="token operator">=</span>frequencies.mol
      <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
    <span class="token punctuation">&amp;</span><span class="token keyword">END</span>

<span class="token punctuation">&amp;</span><span class="token keyword">END</span>

@<span class="token keyword">INCLUDE</span> <span class="token string">'force_eval.inc'</span>

force_eval.inc <span class="token keyword">file</span><span class="token punctuation">:</span>

@SET SCF_CONV   <span class="token number">1.0E-6</span>
@SET CUTOFF        <span class="token number">450</span>
@SET FUNCTIONAL    BLYP
@SET DECOUPLING     MT
@SET CHARGE          <span class="token number">1</span>

<span class="token punctuation">&amp;</span>FORCE_EVAL
   <span class="token punctuation">&amp;</span><span class="token keyword">PRINT</span>
     <span class="token punctuation">&amp;</span>FORCES OFF
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
   <span class="token punctuation">&amp;</span><span class="token keyword">END</span>

  <span class="token punctuation">&amp;</span>MIXED
   <span class="token punctuation">&amp;</span><span class="token keyword">PRINT</span>
    <span class="token punctuation">&amp;</span>DIPOLE
    <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
   <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
  <span class="token punctuation">&amp;</span><span class="token keyword">END</span>

   METHOD QS

   <span class="token punctuation">&amp;</span>DFT
     CHARGE ${CHARGE}
     <span class="token punctuation">&amp;</span>MGRID
       CUTOFF ${CUTOFF}
       NGRIDS <span class="token number">5</span>
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> MGRID
     <span class="token punctuation">&amp;</span>QS
       EPS_DEFAULT <span class="token number">1.0E-12</span>
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> QS
     <span class="token punctuation">&amp;</span>SCF
       SCF_GUESS ATOMIC
       EPS_SCF       ${SCF_CONV}
       MAX_SCF      <span class="token number">30</span>
       <span class="token punctuation">&amp;</span><span class="token keyword">PRINT</span>
         <span class="token punctuation">&amp;</span>RESTART
           LOG_PRINT_KEY T
           FILENAME <span class="token operator">=</span>.<span class="token operator">/</span>WFN_restart.wfn
           <span class="token punctuation">&amp;</span>EACH
             QS_SCF  <span class="token number">0</span>
           <span class="token punctuation">&amp;</span><span class="token keyword">END</span> EACH
           ADD_LAST NUMERIC
           COMMON_ITERATION_LEVELS <span class="token number">1</span>
         <span class="token punctuation">&amp;</span><span class="token keyword">END</span> RESTART
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> <span class="token keyword">PRINT</span>
       <span class="token punctuation">&amp;</span>OT ON
         MINIMIZER DIIS
            <span class="token comment">! MINIMIZER CG</span>
            <span class="token comment">! PRECONDITIONER FULL_ALL</span>
            <span class="token comment">! PRECONDITIONER FULL_KINETIC</span>
         PRECONDITIONER FULL_SINGLE_INVERSE
            <span class="token comment">!ENERGY_GAP  0.001</span>
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> OT
       <span class="token punctuation">&amp;</span>OUTER_SCF
         EPS_SCF ${SCF_CONV}
         MAX_SCF <span class="token number">5</span>
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> OUTER_SCF
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> SCF
     <span class="token punctuation">&amp;</span>XC
       <span class="token punctuation">&amp;</span>XC_FUNCTIONAL ${FUNCTIONAL}
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> XC_FUNCTIONAL
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> XC
@<span class="token keyword">IF</span> <span class="token punctuation">(</span> ${DECOUPLING} <span class="token operator">==</span> NONE <span class="token punctuation">)</span>
     <span class="token punctuation">&amp;</span>POISSON
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
@<span class="token keyword">ENDIF</span>
@<span class="token keyword">IF</span> <span class="token punctuation">(</span> ${DECOUPLING} <span class="token operator">==</span> MT <span class="token punctuation">)</span>
     <span class="token punctuation">&amp;</span>POISSON
        POISSON_SOLVER MT
        PERIODIC NONE
        <span class="token punctuation">&amp;</span>MT
        <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
@<span class="token keyword">ENDIF</span>
@<span class="token keyword">IF</span> <span class="token punctuation">(</span> ${DECOUPLING} <span class="token operator">==</span> WAVELET <span class="token punctuation">)</span>
     <span class="token punctuation">&amp;</span>POISSON
        POISSON_SOLVER WAVELET
        PERIODIC NONE
        <span class="token punctuation">&amp;</span>WAVELET
          SCF_TYPE <span class="token number">60</span>
        <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span>
@<span class="token keyword">ENDIF</span>
   <span class="token punctuation">&amp;</span><span class="token keyword">END</span> DFT

   <span class="token comment">! Include subsys</span>
@<span class="token keyword">INCLUDE</span> <span class="token string">'subsys.inc'</span>
<span class="token punctuation">&amp;</span><span class="token keyword">END</span> FORCE_EVAL


subsys.inc <span class="token keyword">file</span><span class="token punctuation">:</span>
   <span class="token punctuation">&amp;</span>SUBSYS
     <span class="token punctuation">&amp;</span>CELL
#      ABC [angstrom] <span class="token number">23</span> <span class="token number">15</span> <span class="token number">10.0</span>
       ABC [angstrom] <span class="token number">25</span> <span class="token number">17</span> <span class="token number">12</span>
       PERIODIC NONE
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> CELL
     <span class="token punctuation">&amp;</span>TOPOLOGY
       CONNECTIVITY OFF
       COORDINATE   XYZ
       COORD_FILE_NAME fluor.xyz
       CENTER_COORDINATES
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> TOPOLOGY
     <span class="token punctuation">&amp;</span><span class="token keyword">KIND</span> C
       POTENTIAL GTH
       <span class="token punctuation">&amp;</span>POTENTIAL
         # C GTH<span class="token operator">-</span>BLYP<span class="token operator">-</span>q4
     <span class="token number">2</span>    <span class="token number">2</span>
      <span class="token number">0.33806609</span>    <span class="token number">2</span>    <span class="token operator">-</span><span class="token number">9.13626871</span>     <span class="token number">1.42925956</span>
     <span class="token number">2</span>
      <span class="token number">0.30232223</span>    <span class="token number">1</span>     <span class="token number">9.66551228</span>
      <span class="token number">0.28637912</span>    <span class="token number">0</span>
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> POTENTIAL
       <span class="token punctuation">&amp;</span>BASIS
         # C DZVP<span class="token operator">-</span>GTH<span class="token operator">-</span>BLYP
   <span class="token number">2</span>
   <span class="token number">2</span>  <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">4</span>  <span class="token number">2</span>  <span class="token number">2</span>
         <span class="token number">4.3451975957</span>   <span class="token number">0.1511172750</span>   <span class="token number">0.0000000000</span>  <span class="token operator">-</span><span class="token number">0.0883417890</span>
<span class="token number">0.0000000000</span>
         <span class="token number">1.2765552224</span>  <span class="token operator">-</span><span class="token number">0.0330272512</span>   <span class="token number">0.0000000000</span>  <span class="token operator">-</span><span class="token number">0.2797032766</span>
<span class="token number">0.0000000000</span>
         <span class="token number">0.4047139801</span>  <span class="token operator">-</span><span class="token number">0.6994401873</span>   <span class="token number">0.0000000000</span>  <span class="token operator">-</span><span class="token number">0.4686400677</span>
<span class="token number">0.0000000000</span>
         <span class="token number">0.1166096360</span>  <span class="token operator">-</span><span class="token number">0.3842706677</span>   <span class="token number">1.0000000000</span>  <span class="token operator">-</span><span class="token number">0.4085514115</span>
<span class="token number">1.0000000000</span>
   <span class="token number">3</span>  <span class="token number">2</span>  <span class="token number">2</span>  <span class="token number">1</span>  <span class="token number">1</span>
         <span class="token number">0.6000000000</span>   <span class="token number">1.0000000000</span>
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> BASIS
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> <span class="token keyword">KIND</span>
     <span class="token punctuation">&amp;</span><span class="token keyword">KIND</span> F
       POTENTIAL GTH
       <span class="token punctuation">&amp;</span>POTENTIAL
         # F GTH<span class="token operator">-</span>BLYP<span class="token operator">-</span>q7
     <span class="token number">2</span>    <span class="token number">5</span>
      <span class="token number">0.21384014</span>    <span class="token number">2</span>   <span class="token operator">-</span><span class="token number">21.90241518</span>     <span class="token number">3.27597572</span>
     <span class="token number">2</span>
      <span class="token number">0.19459028</span>    <span class="token number">1</span>    <span class="token number">23.79658295</span>
      <span class="token number">0.18786326</span>    <span class="token number">0</span>
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> POTENTIAL
       <span class="token punctuation">&amp;</span>BASIS
         # F DZVP<span class="token operator">-</span>GTH<span class="token operator">-</span>BLYP
   <span class="token number">2</span>
   <span class="token number">2</span>  <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">4</span>  <span class="token number">2</span>  <span class="token number">2</span>
        <span class="token number">10.7284760684</span>   <span class="token number">0.1539953252</span>   <span class="token number">0.0000000000</span>  <span class="token operator">-</span><span class="token number">0.1034591141</span>
<span class="token number">0.0000000000</span>
         <span class="token number">3.1496622427</span>  <span class="token operator">-</span><span class="token number">0.0503062083</span>   <span class="token number">0.0000000000</span>  <span class="token operator">-</span><span class="token number">0.3116781877</span>
<span class="token number">0.0000000000</span>
         <span class="token number">0.9671794608</span>  <span class="token operator">-</span><span class="token number">0.7107682323</span>   <span class="token number">0.0000000000</span>  <span class="token operator">-</span><span class="token number">0.4776960745</span>
<span class="token number">0.0000000000</span>
         <span class="token number">0.2640315133</span>  <span class="token operator">-</span><span class="token number">0.3648266470</span>   <span class="token number">1.0000000000</span>  <span class="token operator">-</span><span class="token number">0.3688578623</span>
<span class="token number">1.0000000000</span>
   <span class="token number">3</span>  <span class="token number">2</span>  <span class="token number">2</span>  <span class="token number">1</span>  <span class="token number">1</span>
         <span class="token number">1.0000000000</span>   <span class="token number">1.0000000000</span>
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> BASIS
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> <span class="token keyword">KIND</span>
     <span class="token punctuation">&amp;</span><span class="token keyword">KIND</span> H
       POTENTIAL GTH
       <span class="token punctuation">&amp;</span>POTENTIAL
         # H GTH<span class="token operator">-</span>BLYP<span class="token operator">-</span>q1
     <span class="token number">1</span>
      <span class="token number">0.20000000</span>    <span class="token number">2</span>    <span class="token operator">-</span><span class="token number">4.19596147</span>     <span class="token number">0.73049821</span>
     <span class="token number">0</span>
       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> POTENTIAL
       <span class="token punctuation">&amp;</span>BASIS
         # H DZV<span class="token operator">-</span>GTH<span class="token operator">-</span>BLYP
[...]

       <span class="token punctuation">&amp;</span><span class="token keyword">END</span> BASIS
     <span class="token punctuation">&amp;</span><span class="token keyword">END</span> <span class="token keyword">KIND</span>
   <span class="token punctuation">&amp;</span><span class="token keyword">END</span> SUBSYS
</code></pre></div><h3 id="a-question-about-wannier-centers"><a href="#a-question-about-wannier-centers" class="header-anchor">#</a> A question about Wannier Centers</h3> <p><strong>Printing of wannier localization center</strong></p> <p>Eric:</p> <p>&quot;Since one of the last commits I've had trouble with the printing of
the wannier centers. It's a rather trivial problem I haven't figured
out yet - Every timestep is printed into a new file, instead of
combining all into the same file. Can anyone let me know what keyword
I need to print to a single file? &quot;</p> <p>Teo:</p> <p>&quot;Sure Erick!  This is a general rule. you get several files because the files are<br>
marked with the iteration levels of the <code>SCF</code> (<code>MD</code> or <code>GEO_OPT</code>, and possibly others)..
The way to get all in one single file is to specify in the print_key<br>
section (the section controlling the print of the <code>WANNIER CENTERS</code>) that
you want more iteration levels in <code>COMMON</code> for the file name (i.e.  don't trace the full index of the iteration levels).</p> <p>The keyword to specify is:</p> <div class="language-fortran extra-class"><pre class="language-fortran"><code>COMMON_ITERATION_LEVELS <span class="token number">3</span> 
</code></pre></div><p>where 3 says that you don't keep track of the 3 inner iteration levels..
In your case 1 should be enough to get all in 1 single file.. anyway specifying a number larger than the maximum number of iteration levels you have when doing the IO is not harmful.. it just takes the maximum number of iteration levels.</p> <p>Keep in mind that the structure of the iteration levels is the<br>
following:</p> <div class="language-fortran extra-class"><pre class="language-fortran"><code>ROOT
      | 
      MD 
        | 
        SCF 
      | 
      GEO 
         | 
         SCF
</code></pre></div><p>(There are of course also others..)</p> <p>The root iteration level is a global one that during &quot;standard&quot; runs<br>
has always a value of 1 (and this is the responsible for the first 1<br>
you see in most of the file names).
Then you may have an iteration level for MD or GEO_OPT (depends what<br>
kind of run you do) and then the iteration level for SCF. In your case the WANNIER centers are printed when the SCF is completed (so no iteration levels for SCF).
This means that your filenames have only two integers:<br>
filename-1_MD. and you get a different file for each MD step.</p> <p>Using <code>COMMON_ITERATION_LEVELS 1</code> makes the filename only with the<br>
iteration level   <code>filename-1</code>.</p> <p>Hope this helps to makes things a little bit more clear! &quot;</p> <p>2011-12-7</p> <div class="language-shell extra-class"><pre class="language-shell"><code>COMMON_ITERATION_LEVELS <span class="token operator">&lt;</span>INTEGER<span class="token operator">&gt;</span>

 How many iterations levels should be written <span class="token keyword">in</span> the same <span class="token function">file</span> <span class="token punctuation">(</span>no extra information about the actual iteration level is written to the <span class="token function">file</span><span class="token punctuation">)</span> This optional keyword cannot be repeated and it expects precisely one integer. Default value: <span class="token number">3</span>
</code></pre></div><p>[1] 先研究简单系统，从简单系统得出一些结论; 然后我们再看这些结论是否可以推广到更一般的系统。</p> <p>[2] 充分利用已有的工具，不要什么都从头制作。</p> <p>[3] From http://cp2k.berlios.de/manual/CP2K_INPUT/FORCE_EVAL/DFT/SCF/PRINT/RESTART.html#desc_COMMON_ITERATION_LEVELS</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/binder/stimulated_raman_spectroscopy.html" class="prev">
        飞秒受激拉曼光谱
      </a></span> <span class="next"><a href="/binder/2018--abinitio.html">
        ab initio Simulations
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5f819d97.js" defer></script><script src="/assets/js/2.94db9d73.js" defer></script><script src="/assets/js/16.d2dd18bf.js" defer></script>
  </body>
</html>
