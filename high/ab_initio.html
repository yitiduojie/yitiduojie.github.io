<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CP2K的安装 | 一题多解</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="description" content="能看懂的自然哲学">
    <link rel="preload" href="/assets/css/0.styles.2be61e54.css" as="style"><link rel="preload" href="/assets/js/app.8117b382.js" as="script"><link rel="preload" href="/assets/js/2.94db9d73.js" as="script"><link rel="preload" href="/assets/js/20.80bb3396.js" as="script"><link rel="prefetch" href="/assets/js/10.c05d6fd5.js"><link rel="prefetch" href="/assets/js/11.59dd88e0.js"><link rel="prefetch" href="/assets/js/12.2477252f.js"><link rel="prefetch" href="/assets/js/13.7738fc19.js"><link rel="prefetch" href="/assets/js/14.541a3eb1.js"><link rel="prefetch" href="/assets/js/15.296b005d.js"><link rel="prefetch" href="/assets/js/16.26d75ea2.js"><link rel="prefetch" href="/assets/js/17.9650d537.js"><link rel="prefetch" href="/assets/js/18.db4f9fce.js"><link rel="prefetch" href="/assets/js/19.11c97ad7.js"><link rel="prefetch" href="/assets/js/21.dd3344f3.js"><link rel="prefetch" href="/assets/js/22.01bd9854.js"><link rel="prefetch" href="/assets/js/23.4ddc53cb.js"><link rel="prefetch" href="/assets/js/24.040f525e.js"><link rel="prefetch" href="/assets/js/25.5ce4eff4.js"><link rel="prefetch" href="/assets/js/26.442be20e.js"><link rel="prefetch" href="/assets/js/27.08f9d8a0.js"><link rel="prefetch" href="/assets/js/28.36196f0c.js"><link rel="prefetch" href="/assets/js/29.98430895.js"><link rel="prefetch" href="/assets/js/3.f92ef955.js"><link rel="prefetch" href="/assets/js/30.1fd67d3f.js"><link rel="prefetch" href="/assets/js/31.875fa268.js"><link rel="prefetch" href="/assets/js/32.f342fa8b.js"><link rel="prefetch" href="/assets/js/33.37b399ca.js"><link rel="prefetch" href="/assets/js/34.12ccf8f1.js"><link rel="prefetch" href="/assets/js/35.85ce727f.js"><link rel="prefetch" href="/assets/js/36.a6e5eb73.js"><link rel="prefetch" href="/assets/js/37.c68542d7.js"><link rel="prefetch" href="/assets/js/38.9dec93e9.js"><link rel="prefetch" href="/assets/js/39.7ad173a2.js"><link rel="prefetch" href="/assets/js/4.6eaeb686.js"><link rel="prefetch" href="/assets/js/40.86203f9f.js"><link rel="prefetch" href="/assets/js/41.4b56cebf.js"><link rel="prefetch" href="/assets/js/5.500f7896.js"><link rel="prefetch" href="/assets/js/6.4bbb7ba8.js"><link rel="prefetch" href="/assets/js/7.b0148503.js"><link rel="prefetch" href="/assets/js/8.8c80f6d0.js"><link rel="prefetch" href="/assets/js/9.e66715f1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2be61e54.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container middle-class"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">一题多解</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  小学
</a></div><div class="nav-item"><a href="/middle/" class="nav-link">
  中学
</a></div><div class="nav-item"><a href="/high/" class="nav-link router-link-active">
  大学
</a></div><div class="nav-item"><a href="/binder/" class="nav-link">
  模拟
</a></div><div class="nav-item"><a href="/jin/" class="nav-link">
  SM
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  小学
</a></div><div class="nav-item"><a href="/middle/" class="nav-link">
  中学
</a></div><div class="nav-item"><a href="/high/" class="nav-link router-link-active">
  大学
</a></div><div class="nav-item"><a href="/binder/" class="nav-link">
  模拟
</a></div><div class="nav-item"><a href="/jin/" class="nav-link">
  SM
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/high/" class="sidebar-link">大学</a></li><li><a href="/high/huang--la.html" class="sidebar-link">从线性方程谈起</a></li><li><a href="/high/expansion.html" class="sidebar-link">矢量的分解</a></li><li><a href="/high/what_is_shearlet.html" class="sidebar-link">Shearlets表示</a></li><li><a href="/high/binutils.html" class="sidebar-link">Binutils Package</a></li><li><a href="/high/functional_derivatives.html" class="sidebar-link">Functional Derivatives</a></li><li><a href="/high/sfg.html" class="sidebar-link">Sum-Frequency Generation Spectroscopy</a></li><li><a href="/high/git.html" class="sidebar-link">Git</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="cp2k的安装"><a href="#cp2k的安装" class="header-anchor">#</a> CP2K的安装</h2> <blockquote><p>作者: Dylan Huang</p> <p>日期：2019年10月13日</p></blockquote> <p>参考： cp2k.org/howto:compile</p> <p>方法：先安装相应的软件包，然后利用arch文件，使用make命令编译。</p> <p>先下载cp2k源代码,并解压:</p> <p>$ wget https://github.com/cp2k/cp2k/archive/v6.1.0.tar.gz</p> <p>$ tar -zxvf v6.1.0.tar.gz</p> <p>第二步：安装必需软件包。下载软件源码，解压，make, make install. 不提.</p> <ul><li>Read toolchain installation options:</li></ul> <div class="language- extra-class"><pre class="language-text"><code>&gt; cd tools/toolchain/
&gt; ./install_cp2k_toolchain.sh --help
</code></pre></div><p>安装哪些工具，该怎么选择？</p> <p>./install_cp2k_toolchain.sh --with-libxsmm=install --with-openblas=system <br>
--with-fftw=system --with-reflapack=no  --enable-cuda=yes  --enable-omp --mpimode=mpich --with-pexsi  --with-ptscotch=yes  --with-parmetis=yes  --with-pexsi =yes  --with-superlu=yes</p> <p>FURTHER INSTRUCTIONS</p> <p>All packages to be installed locally will be downloaded and built inside
./build, and then installed into package specific directories inside
./install.</p> <p>Both ./build and ./install are safe to delete, as they contain
only the files and directories that are generated by this script. However,
once all the packages are installed, and you compile CP2K using the arch
files provided by this script, then you must keep ./install in exactly
the same location as it was first created, as it contains tools and libraries
your version of CP2K binary will depend on.</p> <p>It should be safe to terminate running of this script in the middle of a
build process. The script will know if a package has been successfully
installed, and will just carry on and recompile and install the last
package it is working on. This is true even if you lose the content of
the entire ./build directory.</p> <p>+----------------------------------------------------------------+
|  YOU SHOULD ALWAYS SOURCE ./install/setup BEFORE YOU RUN CP2K  |
|  COMPILED WITH THIS TOOLCHAIN                                  |
+----------------------------------------------------------------+</p> <h3 id="实际操作"><a href="#实际操作" class="header-anchor">#</a> 实际操作</h3> <ol><li></li></ol> <p>./install_cp2k_toolchain.sh --with-libxsmm=install --with-openblas=system   --with-fftw=insnable-cuda=no --with-pexsi  --with-ptscotch=yes  --with-parmetis=yes  --with-pexsi=yes  --with-superlu=yes --with-metis
MPI is detected and it appears to be MPICH
nvcc found, enabling CUDA by default
Compiling with 20 processes.
Step valgrind took 0.00 seconds.</p> <ol start="2"><li>install_cp2k_toolchain.sh好像只接受tar.get格式的文件。比如，在安装libint库时，我的/build/目录中没有tar.gz格式的文件，需要先从libint网站下载一个，文件名如libint-2.6.0.tar.gz，然后复制到/build/文件夹下。只有这样它才会自动安装libint.</li> <li></li></ol> <h3 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h3> <h4 id="cray"><a href="#cray" class="header-anchor">#</a> CRAY</h4> <p>CRAY is a company name. 该公司致力于HPC, 是该领域的行家。CLE:</p> <h4 id="nvcc"><a href="#nvcc" class="header-anchor">#</a> nvcc</h4> <p>It is the purpose of nvcc, the CUDA compiler driver, to hide the intricate details of CUDA compilation from developers. 因为对每一个CUDA源文件，编译过程包含好几个步骤：分离，编译，预处理和合并。</p> <p>sanitizer: 消毒剂</p> <h4 id="pexsi"><a href="#pexsi" class="header-anchor">#</a> PEXSI</h4> <p>A library name. The Ploe EXpansion and Selected Inversion (PESXI) method is a fast method for electronic structure calculation based on KS DFT. 其特点：It efficiently evaluates certain selected elements of matrix functions, eg., the Ferim-Dirac function of the KS Hamiltonian, which yields a density matrix. It can be used as an alternative to diagonalization methods for obtaining the density, energy and forces in electronic structure calculations.  PEXS利用MPI来做并行计算(10,000核)。从线性代数的观点看，PEXSI库的特点是可以作为一种通用的工具以计算一个矩阵函数的某些特定元素(certain selected elements),因此不仅仅适用于电子结构计算，而且可以有更广的应用。(参考: PEXSI文档)</p> <h4 id="quip"><a href="#quip" class="header-anchor">#</a> QUIP</h4> <p>a library name.</p> <h4 id="sirius"><a href="#sirius" class="header-anchor">#</a> SIRIUS</h4> <h4 id="hdf5"><a href="#hdf5" class="header-anchor">#</a> HDF5</h4> <p>HDF5 is also a library name. HDF5 is a popular container for datasets that can grow to terabytes (T) and beyond.  （参考推特网）</p> <h4 id="parmetis"><a href="#parmetis" class="header-anchor">#</a> ParMETIS</h4> <p>a library name.</p> <h4 id="cp2k代码的版本"><a href="#cp2k代码的版本" class="header-anchor">#</a> CP2K代码的版本</h4> <p>CP2K的代码有多种版本。例如，cp2k.sopt: Serial version of CP2K code.  cp2k.popt: parallel version of CP2K code.   Linux-x86-64-gfortran.psmp : a archer file.  cp2k.psmp is a mixed-mode MPI/OpenMP parallel version and it may give better performace than the MPI code on ARCHER when running very large jobs, using 2--4 threads per MPI process. (参考：archer.ac.uk/documentation/software/cp2k)</p> <h4 id="cp2k中的一些模块"><a href="#cp2k中的一些模块" class="header-anchor">#</a> CP2K中的一些模块</h4> <p>经典力场模块FIST，可用于QM/MM计算。尽管它已经优化得比较好，但是其性能还不能和GROMACS, LAMMPS相比。</p> <p>LS-DFT: LS-DFT is typically faster than standard DFT for systems of over 5000 atoms.  Excellent scaling is obtained up to a few atoms per MPI process - and using multiple OpenMP threads per process gives best performance.</p> <h4 id="elpa库"><a href="#elpa库" class="header-anchor">#</a> ELPA库</h4> <p>Large, metallic systems (using DIAGONALIZATION rather than OT) may benefit from using the ELPA library. To enable this, set PREFERRED_DIAG_LIBRARY ELPA in the GLOBAL input section. (参考：archer.ac.uk/documentation/software/cp2k</p> <h4 id="libxsmm库"><a href="#libxsmm库" class="header-anchor">#</a> LIBXSMM库</h4> <p>In the last years, new workloads such as deep learning and more specifically convolutional neural networks (CNN) emerged and are pushing the limits of today's hardware. One of the expensive kernels is a small convolution with certain kernel sizes such that calculations in the frequency space is not the most efficient method when compared with direct convolutions. LIBXSMM's current support for convolutions aims for an easy to use invocation of small (direct) convolutions, which are intended for CNN training and classification. LIBXSMM的目标：为CNN训练和分类提供了一种非常好用的直接卷积。</p> <h4 id="计算机科学-线程与进程"><a href="#计算机科学-线程与进程" class="header-anchor">#</a> (计算机科学)线程与进程</h4> <p>OpenMP threads per process:  一个线程，就是可以被独立处理的最小指令序列。 Threads (in computing) is a sequence of instructions that may execute in parallel with others. 多数情况下，一个线程是一个进程的组成部分。 一个进程中，可以有多线程存在。这些处于同一进程中的线程可以贡献内存资源，同事执行程序。 但是处于不同进程中的线程之间无法共享内存资源。</p> <h4 id="libint库"><a href="#libint库" class="header-anchor">#</a> LIBINT库</h4> <p>其主要目的：致力于高效率地计算量子力学矩阵元(over Gaussian basis sets).</p> <p>其本质： 一个用于高效计算各种两体<mark>分子积分</mark>的C/C++模块。（Ealuation of several kinds of two-body molecular integrals over Gaussian functions.）算符可以用矩阵表示，这个矩阵的矩阵元就可用用分子积分表示出来。</p> <h4 id="plumed库"><a href="#plumed库" class="header-anchor">#</a> PLUMED库</h4> <p>Plumed is a plugin for enhanced sampling and analysis of molecular dynamics simulations. PLUMED is an open-source, community-developed library that provides a wide range of different methods, which include: (1) enhanced-sampling algorithms; (2) free-energy methods; (3) tools to analyze the vast amounts of data produced by MD simulations.</p> <h2 id="第一性原理模拟"><a href="#第一性原理模拟" class="header-anchor">#</a> 第一性原理模拟</h2> <p>u</p> <h2 id="plugin-for-the-vim-editor"><a href="#plugin-for-the-vim-editor" class="header-anchor">#</a> Plugin for the Vim editor</h2> <h3 id="syntax-highlighting-for-cp2k-input-file-inp"><a href="#syntax-highlighting-for-cp2k-input-file-inp" class="header-anchor">#</a> Syntax highlighting for CP2K input file (.inp)</h3> <div class="language- extra-class"><pre><code>(base) huang@xian /home/huang [2]$ mkdir -p ~/.vim/syntax
(base) huang@xian /home/huang [3]$ wget -O ~/.vim/syntax/cp2k.vim http://manual.cp2k.org/trunk/cp2k.vim
</code></pre></div><p>In addition create a file with the name filetype.vim in the ~/.vim folder containing the following lines</p> <div class="language- extra-class"><pre><code>if exists(&quot;did_load_filetypes&quot;)
   finish
endif
augroup filetypedetect
   au! BufNewFile,BufRead *.inp setf cp2k
augroup END
</code></pre></div><p>which causes that all files with the name extension '.inp' will be considered as CP2K files by the Vim editor.</p> <h2 id="pimd-in-cp2k"><a href="#pimd-in-cp2k" class="header-anchor">#</a> PIMD in CP2K</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">timeout</span> 1430m aprun -B cp2k.psmp <span class="token variable">$inp_cp2k</span> <span class="token operator">&gt;</span> <span class="token variable">$out_cp2k</span>
</code></pre></div><p>The aprun command is used to run a compiled application program across one or more computer nodes. Eg, Each Titan compute node contains(2) 8-core NUMA nodes on a single socket (a total of 16 cores).</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8117b382.js" defer></script><script src="/assets/js/2.94db9d73.js" defer></script><script src="/assets/js/20.80bb3396.js" defer></script>
  </body>
</html>
